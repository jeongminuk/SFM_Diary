# SFM_Diary
Structure From Motion

###

이 프로젝트를 계획하게 된 계기는 일기를 쓸 때 오늘하루 내가 뭐했는지 기억이 안나고 시간 순서대로 뭐했는지 궁금할 때 사진첩을 기반으로 오늘 하루 일정에 대한 타임라인을 만들어서 일기 쓸 때 편하게 해주면 좋겠다는 생각이 들어서 계획하게 되었습니다. 
또 더욱 기억해내기 편하게 Structure From Motion을 통해서 이동한 동선이나 봤던 건물, 장소를 보여주면 좋을 것 같다는 생각이 들어 SFM을 구현해보고자 합니다.


아래 에러가 발생한 이유는, 최신 Open3D에서 VisualizerWithEditing 객체에 더 이상 register_mouse_callback 메서드를 제공하지 않기 때문입니다. 대신, Open3D의 “Picking Mode” (Shift + 왼쪽 클릭) 기능으로 포인트를 선택한 뒤, 윈도우를 닫은 이후에 get_picked_points()를 호출하여 선택된 포인트 인덱스를 가져오는 방식을 사용해야 합니다.

Open3D 뷰어 창이 뜹니다.
Shift + 왼쪽 클릭으로 “포인트 하나 이상”을 선택하세요.
(여러 점을 골라도 됩니다. 각 점들에 가장 가까운 카메라 이미지를 찾습니다.)
사용법:
마우스 왼쪽 버튼 드래그: 씬 회전
오른쪽 버튼(또는 휠 버튼) 드래그: 씬 평행 이동
휠 스크롤: 화면 확대/축소
선택을 마쳤으면, Q(또는 Esc) 키를 눌러 뷰어 창을 닫습니다.

뷰어가 닫히면, picked_ids = vis.get_picked_points() 를 통해 “선택된 포인트 인덱스 목록”을 가져옵니다.

선택된 각 인덱스별로:

1. 해당 3D 포인트 좌표(pt)를 가져옵니다.
2. camera_poses 에서 미리 구해둔 “모든 카메라 위치 좌표”와 비교해, 가장 가까운 카메라를 찾습니다.
3. 그 카메라(이미지) 이름(파일명)을 images/ 폴더에서 찾아 OpenCV 창으로 띄웁니다.
4. 같은 이미지가 중복으로 뜨지 않도록 seen_images 집합을 만들어 관리합니다.
5. 모든 선택된 포인트에 대해 팝업을 띄우고 나면, 콘솔에 “모든 선택된 포인트에 대해 팝업을 완료했습니다. 프로그램을 종료합니다.” 라는 메시지가 출력되며 프로그램이 끝납니다.

참고자료 : https://colmap.github.io/datasets.html# (데이터 셋 활용)